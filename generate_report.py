import json
import pandas as pd
import os

# Cargar el reporte de Grype
with open('grype-report.json') as f:
    data = json.load(f)

# Extraer las vulnerabilidades
vulnerabilities = []
for match in data['matches']:
    vulnerabilities.append({
        'Repository': os.getenv('REPO_URL'),
        'Vulnerability': match['vulnerability']['id']
    })

# Crear un DataFrame y guardarlo en un archivo Excel
df = pd.DataFrame(vulnerabilities)
df.to_excel('vulnerability_report.xlsx', index=False)
